import{atou,addFunctionToResizeEvent,getTriggers,disableSmoothScroll,}from"../theme/modules/helpers.min.js";const INTRO_STEPS="steps",INTRO_EXIT_BOOL="isExiting",INTRO_TRIGGER_ONLY="triggeronly",INTRO_TRIGGER_EXCEPT="triggerexcept",INTRO_THEME_FUNCTIONS={oncomplete:{applyOnStep:!1,callBack:""},onexit:{applyOnStep:!1,callBack:"enableSmoothScroll();"},onbeforeexit:{applyOnStep:!1,callBack:""},onchange:{applyOnStep:!0,callBack:""},onbeforechange:{applyOnStep:!0,callBack:""},onafterchange:{applyOnStep:!0,callBack:""}},themeCommonOptions={nextLabel:introNextLabel,prevLabel:introPrevLabel,skipLabel:introSkipLabel,doneLabel:introDoneLabel,hidePrev:!1,hideNext:!1,nextToDone:!0,exitOnEsc:!0,exitOnOverlayClick:!0,showStepNumbers:!1,keyboardNavigation:!0,showButtons:!0,showBullets:!0,showProgress:!0,scrollToElement:!0,scrollTo:"element",scrollPadding:30,overlayOpacity:.8,disableInteraction:!0},introErrorTitle=atou(document.getElementById("intro-error-title").getAttribute("data")),introError=atou(document.getElementById("intro-error").getAttribute("data")),introEmpty=atou(document.getElementById("intro-empty").getAttribute("data")),introErrorStep={showBullets:!1,steps:[{title:introErrorTitle,intro:introError}]},introEmptyStep={showBullets:!1,steps:[{title:introErrorTitle,intro:introEmpty}]},divi=document.getElementsByClassName("sc-intro");for(let e=0;e<divi.length;e++)divi[e].addEventListener("click",function(){disableSmoothScroll();let n=parseIntroOptions(atou(divi[e].getAttribute("intro-data")));n.steps=manageTriggeredSteps(n.steps,getTriggers());let t=introJs();t.setOptions(themeCommonOptions),t.setOptions(manageEmptySteps(n));for(const e in INTRO_THEME_FUNCTIONS)typeof t[e]=="function"&&t[e](function(){INTRO_THEME_FUNCTIONS[e].applyOnStep?(Function(INTRO_THEME_FUNCTIONS[e].callBack)(),this._introItems[this.currentStep()].hasOwnProperty(e)&&Function(this._introItems[this.currentStep()][e])()):(Function(INTRO_THEME_FUNCTIONS[e].callBack)(),n.hasOwnProperty(e)&&Function(n[e])())});const s=function(){t[INTRO_EXIT_BOOL]||(t.isExiting=!0,t.exit(!0))};addFunctionToResizeEvent(s),t.start()});function parseIntroOptions(e){try{let t=JSON.parse(e);return manageElements(manageEmptySteps(t))}catch{return introErrorStep.steps[0].intro=introError,introErrorStep}}function manageElements(e){for(let t=0;t<e.steps.length;t++)if(e.steps[t].element)try{e.steps[t].element=document.querySelector(e.steps[t].element)}catch{try{e.steps[t].element=Function("return "+e.steps[t].element)()}catch{return introErrorStep.steps[0].intro=introError+`<br><i>(Step${t}:${e.steps[t].element})</i>`,introErrorStep}}return e}function manageEmptySteps(e){return e.hasOwnProperty(INTRO_STEPS)&&e[INTRO_STEPS].length>0?e:introEmptyStep}function manageTriggeredSteps(e,t){let n=[];for(let s=0;s<e.length;s++)keepSteps(e[s],t)&&(n[n.length]=e[s]);return n}function keepSteps(e,t){let n=!0;if(e.hasOwnProperty(INTRO_TRIGGER_ONLY)){n=!1;for(const s of e[INTRO_TRIGGER_ONLY])if(t.includes(s)){n=!0;break}}if(e.hasOwnProperty(INTRO_TRIGGER_EXCEPT))for(const s of e[INTRO_TRIGGER_EXCEPT])if(t.includes(s)){n=!1;break}return n}